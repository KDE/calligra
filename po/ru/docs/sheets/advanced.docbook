<chapter id="hardsums">
<chapterinfo>
<authorgroup>
<author
><firstname
>Pamela</firstname
> <surname
>Robert</surname
> <affiliation
> <address
><email
>pamroberts@blueyonder.co.uk</email
></address>
</affiliation>
</author>
<author
><firstname
>Anne-Marie</firstname
> <surname
>Mahfouf</surname
> <affiliation
> <address
><email
>annemarie.mahfouf@free.fr</email
></address>
</affiliation>
</author>
<othercredit role="translator"
><firstname
>Ivan</firstname
><surname
>Petrov</surname
><affiliation
><address
><email
>pis00593@udmglzs.udmene.ru</email
></address
></affiliation
><contrib
>Перевод на русский</contrib
></othercredit
> <othercredit role="translator"
><firstname
>Пётр</firstname
><surname
>Скляр</surname
><affiliation
><address
><email
>deusextranslation@rambler.ru</email
></address
></affiliation
><contrib
>Перевод на русский</contrib
></othercredit
><othercredit role="translator"
><firstname
>Мария</firstname
><surname
>Шикунова</surname
><affiliation
><address
><email
>translation-team@basealt.ru</email
></address
></affiliation
><contrib
>Обновление перевода на русский</contrib
></othercredit
> 
</authorgroup>
</chapterinfo
> 
<title
>Расширенные возможности &sheets;</title>
<sect1 id="series">
<title
>Ряды</title>
<para
>При создании электронной таблицы часто бывает необходимо включать ряды значений, таких как 10, 11, 12..., в строку или столбец. Сделать это в &kspread; возможно несколькими способами.</para>
<para
>Для простых коротких рядов, таких как 5, 6, 7, 8... наиболее простым методом является <quote
>Перетаскивание и копирование</quote
>. Введите начальное значение в первую ячейку и следующее значение ряда в следующую. Затем выделите обе ячейки и наведите указатель мыши на маленький квадрат в нижнем правом углу выделения; указатель станет диагональной направленной в две стороны стрелкой. Затем нажмите и удерживайте <mousebutton
>левую</mousebutton
> кнопку мыши и перенесите указатель вдоль или поперёк до необходимого положения.</para>
<para
>Размер шага вычисляется как разница между двумя введёнными значениями. Например, если ввести <userinput
>4</userinput
> в ячейку A1 и <userinput
>3,5</userinput
> в ячейку A2, а затем выделить обе ячейки, перетащить их и скопировать вниз, размер шага будет равен значению A2 минус значение A1, в этом случае — «-0,5», — и в результате получится следующий ряд: 4, 3,5, 3, 2,5, 2...</para>

<para
>Метод <quote
>Перетаскивания с копированием</quote
> работает даже с рядами, в которых значение шага является не постоянным. При вводе 1, 3, 4, 6 перетаскивание и копирование расширит его до 1, 3, 4, 6, 7, 9, 10, 12..., а значения шага в этом примере — это серия  2, 1, 2, 1...</para>

 <!--FIXME does not work here -->
<para
>&sheets; также распознаёт некоторые специальные <quote
>ряды</quote
>, такие как дни недели. Попробуйте ввести в ячейку слово <userinput
>Пятница</userinput
> (с учётом регистра), затем выполните описанную выше операцию. Чтобы узнать, какие существуют специальные ряды, а также создать свои созданные, воспользуйтесь меню <menuchoice
><guimenu
>Сервис</guimenu
> <guimenuitem
>Списки пользователя...</guimenuitem
></menuchoice
> .</para>

<para
>При выборе варианта <guimenuitem
>Ряд...</guimenuitem
> в меню <guimenu
>Вставка</guimenu
> появится диалог <guilabel
>Настройка ряда</guilabel
>. Это полезно для создания длинных, которые неудобно создавать методом перетаскивания с копированием или для создания геометрических рядов, таких как 1, 1,5, 2,25, 3,375..., где величина шага, в данном случае 1,5, используется как множитель.</para>
<para
>Если тип ряда, который требуется создать, слишком сложен для любого из приведённых методов, рекомендуется воспользоваться формулой и перетащить её с копированием. Например, чтобы создать ряд 2, 4, 16, 256..., введите <userinput
>2</userinput
> в ячейку A1, <userinput
>=A1*A1</userinput
> в ячейку A2 и перетащите с копированием ячейку A2 вниз.</para>
</sect1>

<sect1 id="formulas">
<title
>Формулы</title>
<sect2 id="builtin">
<title
>Встроенные функции</title>
<para
>В &sheets; встроено большое количество математических и других <link linkend="functions"
>функций</link
>, которые возможно использовать в ячейках с формулами. Доступ к ним возможно получить с помощью пункта <guimenuitem
>Функция...</guimenuitem
> в меню <guimenu
>Вставка</guimenu
>. После этого появится диалог <guilabel
>Функция</guilabel
>.</para>
<para
>Выберите функцию из списка в левой части диалога. На вкладке <guilabel
>Справка</guilabel
> отобразится описание функции: тип возвращаемого значения, синтаксис, аргументы и примеры использования. Кроме того, на этой странице часто содержатся ссылки на другие связанные функции. Чтобы вставить функцию в поле редактирования текста внизу диалога, нажмите кнопку с символом направленной вниз стрелки.</para>
<para
>Откроется вкладка <guilabel
>Параметры</guilabel
>, на которой возможно указать параметры для только что выбранной функции. Для ввода фактического значения параметра просто введите его в соответствующее текстовое поле на странице  <guilabel
>Параметры</guilabel
>. Чтобы ввести ссылку на ячейку, а не значение, щёлкните <mousebutton
>левой</mousebutton
> кнопкой мыши по соответствующей строке ввода, а затем по целевой ячейке.</para>
<para
>Вместо использования вкладки <guilabel
>Параметры</guilabel
>, ссылки на ячейки, такие как <userinput
>B6</userinput
>, возможно ввести непосредственно в строке редактирования внизу диалога <guilabel
>Функция</guilabel
>. Если функция имеет более одного параметра, то их следует разделять точкой с запятой (<keysym
>;</keysym
>).</para>
<para
>Нажатие <guibutton
>OK</guibutton
> приведёт к вставке функции в текущую ячейку и закрытию диалога <guilabel
>Функция</guilabel
>.</para>
<para
>Возможно обойтись без диалога <guilabel
>Функция</guilabel
> и просто вводить полные выражения в главной строке для ввода текста на панели инструментов. Названия функций не зависят от регистра. Не забывайте о том, что любое выражение должно начинаться со знака <keysym
>=</keysym
>.</para>
</sect2>

<sect2 id="logical">
<title
>Логические сравнения</title>
<para
>Логические функции, такие как IF(), AND(), OR() принимают параметры, которые имеют логические (булевые) значения «Истина» или «Ложь». Значения этого типа могут быть получены в результате выполнения других логических функций, таких как ISEVEN(), или путём сравнения значений в ячейках электронной таблицы с помощью операторов сравнения, приведённых в таблице ниже.</para>

<informaltable
><tgroup cols="3">
<thead>
<row>
<entry
>Выражение </entry>
<entry
>Описание </entry>
<entry
>Пример </entry
></row>
</thead>
<tbody>

<row
><entry
><keysym
>=</keysym
><keysym
>=</keysym
></entry>
<entry
>равно</entry>
<entry
><userinput
>A2==B3</userinput
> Истина, если значение в A2 равно значению в B3</entry>
</row>

<row
><entry
><keysym
>!</keysym
><keysym
>=</keysym
></entry>
<entry
>не равно</entry>
<entry
><userinput
>A2!=B3</userinput
> Истина, если значение в A2 не равно значению в B3</entry>
</row>

<row
><entry
><keysym
>&lt;</keysym
><keysym
>&gt;</keysym
></entry>
<entry
>не равно</entry>
<entry
>То же самое, что и <userinput
>A2!=B3</userinput
></entry>
</row>

<row
><entry
><keysym
>&lt;</keysym
></entry>
<entry
>меньше</entry>
<entry
><userinput
>A2&lt;B3</userinput
> Истина, если значение в A2 меньше, чем значение в B3</entry>
</row>

<row
><entry
><keysym
>&lt;</keysym
><keysym
>=</keysym
></entry>
<entry
>меньше или равно</entry>
<entry
><userinput
>A2&lt;=B3</userinput
> Истина, если значение в A2 меньше или равно значению в B3</entry>
</row>

<row
><entry
><keysym
>&gt;</keysym
></entry>
<entry
>больше</entry>
<entry
><userinput
>A2&gt;B3</userinput
> Истина, если значение в A2 больше значения в B3</entry>
</row>

<row
><entry
><keysym
>&gt;</keysym
><keysym
>=</keysym
></entry>
<entry
>больше или равно</entry>
<entry
><userinput
>A2&gt;=B3</userinput
> Истина, если значение в A2 больше или равно значению в B3</entry>
</row>

</tbody
></tgroup
></informaltable>

<para
>Таким образом, при вводе в ячейку <userinput
>=IF(B3&gt;B1;"BIGGER";"")</userinput
> в ней будет отображаться BIGGER, если значение в ячейке B3 больше значения в ячейке B1, в противном случае не будет отображаться ничего.</para>
</sect2>

<sect2 id="absolute">
<title
>Абсолютные ссылки на ячейки</title>
<para
>Если в формуле содержится ссылка на ячейку, то при её копировании в другую часть электронной таблицы она изменится. Чтобы это избежать, поместите знак <keysym
>$</keysym
> перед буквой столбца, номером строки или перед тем и другим. </para>

<itemizedlist>
<listitem
><para
>Если в A1 содержится формула <userinput
>=D5</userinput
>, то при копировании её в ячейку B2 она изменится на <userinput
>=E6</userinput
> (обычное поведение). </para
></listitem>
<listitem
><para
>Если в A1 содержится формула <userinput
>=$D5</userinput
>, то при копировании её в ячейку B2 она изменится на <userinput
>=D6</userinput
> (буква столбца не поменяется). </para
></listitem>
<listitem
><para
>Если в A1 содержится формула <userinput
>=D$5</userinput
>, то при копировании её в ячейку B2 она изменится на <userinput
>=E5</userinput
> (номер строки не поменяется). </para
></listitem>
<listitem
><para
>Если в A1 содержится формула <userinput
>=$D$5</userinput
>, то при копировании её в ячейку B2 она останется такой же <userinput
>=D5</userinput
> (номер строки и буква столбца не поменяются). </para
></listitem>

</itemizedlist>
<para
>При вводе или редактировании в формуле ссылку на ячейку используйте <keysym
>F4</keysym
> для переключения между этими четырьмя возможностями.</para>
<para
><link linkend="namedareas"
>Именованные ячейки</link
> также возможно использовать подобным образом для включения в формулы неизменяемых ссылок на ячейки. </para>
</sect2>
</sect1>

<sect1 id="sumspecialpaste">
<title
>Вычисления с использованием Специальной вставки</title>
<para
>Иногда необходимо прибавить одно число к нескольким ячейкам, или вычесть его из них, либо умножить или разделить их на одно и то же число. Пункт меню <guimenuitem
>Специальная вставка...</guimenuitem
> позволяет сделать это просто и быстро.</para>
<para
>Сначала введите значение модификатора в любую свободную ячейку таблицы и <guimenuitem
>Скопируйте</guimenuitem
> его в буфер обмена. Затем выберите ячейки, которые требуется изменить, выберите <guimenuitem
>Специальная вставка...</guimenuitem
> из меню <guimenu
>Правка</guimenu
> или контекстного меню, и выберите <guilabel
>Сложить</guilabel
>, <guilabel
>Вычесть</guilabel
>, <guilabel
>Умножить</guilabel
> или <guilabel
>Разделить</guilabel
> из секции <guilabel
>Операция</guilabel
> диалогового окна.</para>
<para
>Также возможно применить разные значения модификатора к разным столбцам или строкам целевой области, скопировав область данных содержащую необходимые модификаторы перед выделением целевой области и выполнением <guimenuitem
>Специальной вставки...</guimenuitem
>. Например, при вводе <userinput
>5</userinput
> в ячейку A1, <userinput
>10</userinput
> в B1, выделении обеих ячеек и копировании в буфер обмена, затем вызове <guimenuitem
>Специальная вставка...</guimenuitem
>, <guilabel
>Сложить</guilabel
> к ячейкам от A10 до D15, то 5 будет прибавлено к ячейкам A10:A15 и C10:C15, а 10 - к ячейкам B10:B15 и D10:D15.</para>
<para
>Обратите внимание, что значение модификатора может быть как простым числовым значением, так и формулой. Если это формула, то &sheets; преобразует ссылки на ячейки так же, как и при обычной операции <guimenuitem
>Вставить</guimenuitem
>.</para>
</sect1>

<sect1 id="arrayformulas">
<title
>Формулы массива</title>
<para
>&sheets; позволяет использовать формулы, результатом которых являетчя матрица или диапазон значений. Обычно в ячейке отображается только первое значение. Чтобы отобразить всю матрицу целиком, используйте комбинацию клавиш <keycombo
>&Ctrl;&Alt;&Enter;</keycombo
> при редактировании формулы, и она будет преобразована в формулу массива, занимая соседние ячейки по мере необходимости.</para>
<para
>Ячейки, являющиеся частью формулы массива, невозможно изменить.</para>
</sect1>

<sect1 id="goalseek">
<title
>Поиск решения</title>
<para
>&sheets; возможно использовать для решения алгебраических решений, таких как <emphasis
> x + x^2 = 4</emphasis
> или <emphasis
>При каком значении x выражение x + x в квадрате равноl 4?</emphasis
></para>
<para
>Например, в ячейку A1 возможно ввести <userinput
>=A2+A2*A2</userinput
> и подбирать значение в ячейке A2, пока результат в ячейке A1 не станет настолько близок к <emphasis
>4</emphasis
>, насколько это требуется. Рекомендуется воспользоваться функцией <guimenuitem
>Поиск решения</guimenuitem
>, которая автоматически подберёт значение в одной ячейке так, чтобы значение в другой было максимально близко к желаемому.</para>
<para
>Эту функцию возможно вызвать с помощью пункта <guimenuitem
>Поиск решения</guimenuitem
> в меню <guimenu
>Данные</guimenu
>. Появится диалог, в котором нужно будет ввести ссылку на ячейку, в которой будет находиться результат (в данном случае <userinput
>A1</userinput
>) в поле <guilabel
>Ячейка с формулой:</guilabel
>, само значение требуемого результата (<userinput
>4</userinput
>) в поле <guilabel
>Целевое значение:</guilabel
> и ссылку на изменяемую ячейку (<userinput
>A2</userinput
>) в поле <guilabel
>Изменяемая ячейка:</guilabel
>. Обратите внимание, что перед началом <guimenuitem
>Поиска решения</guimenuitem
> в изменяемую ячейку необходимо ввести какое-либо начальное значение.</para>
<para
>После нажатия на кнопку <guibutton
>OK</guibutton
> начнутся вычисления. Когда они закончатся, и если будет найдено решение, нажмите кнопку <guibutton
>OK</guibutton
>, чтобы принять результат, или <guibutton
>Отмена</guibutton
>, чтобы оставить начальное значение. </para>
</sect1>

 <sect1 id="pivottable">
   <title
>Сводные таблицы</title>
   <para
>С помощью &sheets; возможно составлять <ulink url="http://en.wikipedia.org/wiki/Pivot_table"
>сводные таблицы</ulink
>, используя данные текущей таблицы. </para>
   <para
>Для вызова этой функции воспользуйтесь пунктом <guimenuitem
>Сводные таблицы...</guimenuitem
> меню <guimenu
>Данные</guimenu
>. Ниже представлен пример созданной сводной таблицей. </para>
   <para
>Допустим, имеется следующий набор данных. </para>
   <para>
     <mediaobject>
       <imageobject>
	 <imagedata fileref="pivot1.png" format="PNG"/>
       </imageobject>
       <textobject>
	 <phrase
>Начальная таблица</phrase>
       </textobject>
     </mediaobject>
   </para>
   <para
>Требуется создать сводную таблицу с определённым набором данных и параметров. Для этого воспльзуйтесь пунктом <menuchoice
> <guimenu
>Данные</guimenu
> <guimenuitem
>Сводная таблица...</guimenuitem
> </menuchoice
>. </para>
     <para
>Появившийся диалог позволяет выбрать источник данных. Данные могут быть взяты из текущего рабочего листа или из внешнего источника, такого как база данных или файл <abbrev
>ODS</abbrev
>. </para>
     <para>
       <mediaobject>
	 <imageobject>
	   <imagedata fileref="pivot2.png" format="PNG"/>
	 </imageobject>
	 <textobject>
	   <phrase
>Выбор источника данных</phrase>
	 </textobject>
       </mediaobject>
     </para>
     <para
>Здесь представлен диалог, который позволяет настроить сводную таблицу. Метки столбцов в исходных данных преобразуются в метки, которые служат рабочими полями. Для создания сводной таблицы метки возможно перетащить в одну из трёх областей (<guilabel
>Строки</guilabel
>, <guilabel
>Столбцы</guilabel
> или <guilabel
>Значения</guilabel
>). Чтобы сбросить свой выбор, нажмите кнопку <guibutton
>Сбросить DnD</guibutton
>. </para>
     <para>
       <mediaobject>
	 <imageobject>
	   <imagedata fileref="pivot3.png" format="PNG"/>
	 </imageobject>
	 <textobject>
	   <phrase
>Сводная таблица в диалоге настройки</phrase>
	 </textobject>
       </mediaobject>
     </para>
     <para
>В рассматриваемом примере <replaceable
>Имя</replaceable
> перенесено в <guilabel
>Строки</guilabel
>, <replaceable
>Категория</replaceable
> — в <guilabel
>Столбцы</guilabel
>, <replaceable
>Счёт</replaceable
> — в <guilabel
>Значения</guilabel
>. Чтобы выбрать тип отображения данных, например, сумму, среднее, максимум, минимум и так далее, воспользуйтесь списком <guilabel
>Выбрать функцию</guilabel
>. </para>
     <para
>Кнопка <guibutton
>Добавить фильтр</guibutton
> используется для открытия диалога с параметрами фильтрации используемых данных. Этот диалог позволяет задать несколько фильтров, основанных на метке столбца и отношениях между ними (<guimenuitem
>И</guimenuitem
> или <guimenuitem
>Или</guimenuitem
>). Это позволяет настраивать данные с максимальной свободой. </para>
     <para>
       <mediaobject>
	 <imageobject>
	   <imagedata fileref="pivot4.png" format="PNG"/>
	 </imageobject>
	 <textobject>
	   <phrase
>Диалог фильтра сводной таблицы</phrase>
	 </textobject>
       </mediaobject>
     </para>
     <para
><guilabel
>Всего строк</guilabel
> и <guilabel
>Всего столбцов</guilabel
>: эти флажки позволяют автоматически суммировать соответствующие строки и столбцы в сводной таблице. </para>
   </sect1>

<sect1 id="worksheets">
<title
>Использование нескольких рабочих листов</title>
<para
>При создании нового пустого документа &sheets; будет создано несколько пустых листов. Количество создаваемых листов определяется выбранным шаблоном.</para>
<para
><menuchoice
><guimenu
>Вставка</guimenu
><guimenuitem
>Лист</guimenuitem
></menuchoice
> добавит ещё один лист в рабочую книгу.</para>
<para
>Также возможно переключаться между листами с помощью соответствующих комбинаций клавиш <keycombo action="simul"
>&Ctrl;<keysym
>PgDown</keysym
></keycombo
>: для перехода на следующий лист, <keycombo action="simul"
>&Ctrl;<keysym
>PgUp</keysym
></keycombo
> для перехода на предыдущий лист.</para>
<para
>По умолчанию листам даются названия <emphasis
>Лист1</emphasis
>, <emphasis
>Лист2</emphasis
> и так далее. Чтобы переименовать лист, щёлкните <mousebutton
>правой</mousebutton
> кнопкой мыши по названию листа и в открывшемся контекстном меню выберите <guimenuitem
>Переименовать лист...</guimenuitem
>.</para>
<para
>Чтобы удалить лист из рабочей книги, используйте функцию <guimenuitem
>Удалить лист</guimenuitem
> в контекстном меню, которое вызывается щелчком <mousebutton
>правой</mousebutton
> кнопки мыши по вкладке листа, который требуется удалить.</para>
<para
>Остальные элементы вложенного <menuchoice
><guimenu
>Формат</guimenu
><guisubmenu
>Лист</guisubmenu
></menuchoice
> позволяют показать или спрятать лист таким же образом, каким возможно скрыть строки или столбцы.</para>
<para
>Чтобы формула на одном листе ссылалась на значение из ячейки на другом листе, ссылка на ячейку должна начинаться с имени листа с восклицательным знаком (<keysym
>!</keysym
>). Например, при вводе <userinput
>=Sheet2!A2 </userinput
> в ячейку на листе 1 эта ячейка примет значение из ячейки A2 листа 2. Обратите внимание, что имена листов чувствительны к регистру.</para>


<sect2 id="consolidate">
<title
>Консолидация данных</title>
<para
>Например, если была создана рабочая книга, содержащая рабочие листы со сходными данными, но относящиеся, скажем, к разным месяцам года, и требуется получить сводную таблицу, содержащую консолидированные (например, суммарные или средние) значения соответствующих элементов данных из разных листов.</para>
<para
>Эту задачу возможно облегчить, используя пункт <guimenuitem
>Консолидировать...</guimenuitem
> в меню <guimenu
>Данные</guimenu
>.</para>
<para
>После выбора этого пункта откроется окно <guilabel
>Консолидация данных</guilabel
>.</para>
<para
>Для каждого исходного листа введите ссылку на область с желаемыми данными в поле <guilabel
>Ссылка:</guilabel
>. Нажмите <guibutton
>Добавить</guibutton
>, чтобы перенести его в поле <guilabel
>Введённые ссылки:</guilabel
>. The reference should include the name of the sheet containing the source data, such as <userinput
>January!A1:A10</userinput
>, and can be entered automatically by selecting the area in the appropriate sheet. Для каждого из исходных листов введите ссылку на нужную область данных в поле <guilabel
>Настройки:</guilabel
>. Нажмите <guibutton
>Добавить</guibutton
>, чтобы перенести его в поле <guilabel
>Введенные ссылки:</guilabel
>. Ссылка должна включать название листа, содержащего исходные данные, например <userinput
>Январь!A1:A10</userinput
>, и может быть введен автоматически, выбрав область на соответствующем листе.Для каждого исходного листа введите ссылку на область с желаемыми данными в поле <guilabel
>Ссылка</guilabel
> и нажмите кнопку <guibutton
>Добавить</guibutton
>, которая перенесёт ссылку в поле <guilabel
>Введённые ссылки</guilabel
>. Ссылка должна включать имя листа, содержащего исходные данные, например, <userinput
>Январь!A1:A10</userinput
>, и её можно ввести выделив область на соответствующем листе.</para>
<para
>После ввода ссылок на все исходные листы выберите ячейку на целевом листе, в которой будет располагаться верхний левый угол консолидированных результатов, выберите соответствующую функцию из раскрывающегося списка <guilabel
>Функция:</guilabel
> и нажмите кнопку <guibutton
>OK</guibutton
>.</para>
<para
>При нажатии <guibutton
>Подробности 
>
></guibutton
> в диалоге и установке флажка <guilabel
>Копировать данные</guilabel
> значения, полученные в результате консолидации, будут помещены в целевые ячейки, а не в формулы для их вычисления. </para>
</sect2>
</sect1>
<sect1 id="insertchart">
<title
>Вставка диаграммы</title>
<para
>Диаграммы помогают представлять данные более наглядно.</para>
<para
>Для начала включите панель <guilabel
>Объекты</guilabel
> с помощью меню <menuchoice
> <guimenu
>Настройка</guimenu
><guimenuitem
>Панели</guimenuitem
> </menuchoice
>.</para>
<para
>Затем выделите область ячеек, содержащих данные, а на панели <guilabel
>Объекты</guilabel
> выберите вариант <guilabel
>Диаграмма</guilabel
>. Перетащите указатель мыши по листу, удерживая <mousebutton
>левую</mousebutton
> кнопку мыши нажатой, чтобы указать область, которая будет использоваться для создания диаграммы. На этом этапе необязательно указывать всё точно, так как размер диаграммы возможно легко изменить в любое время. Отпустите кнопку мыши, и появится диалог <guilabel
>Параметры диаграммы</guilabel
>.</para>
<para
>Область данных уже предварительно заполнена выбранным диапазоном ячеек. Выберите первую строку и столбец в качестве меток, установите флажок <guilabel
>Набор данныз в строках</guilabel
>и нажмите <guibutton
>OK</guibutton
>. Диалог исчезнет, и появится диаграмма, встроенная в рабочий лист.</para>
<para
>На панели <guibutton
>Инструменты</guibutton
> выберите <guilabel
>Инструмент редактирования диаграмм</guilabel
> и измените свойства диаграммы, такие как тип диаграммы, метки, и оси.</para>
<para>
<mediaobject>
<imageobject>
<imagedata fileref="chart1.png" format="PNG"/>
</imageobject>
<textobject>
<phrase
>Снимок экрана со встроенной диаграммой</phrase>
</textobject>
</mediaobject>
</para>
<para
>Чтобы переместить, изменить размер или даже удалить диаграмму, переключитесь на инструмент <guibutton
>Основные манипуляции с объектами</guibutton
> и щёлкните левой кнопкой мыши в любом месте области диаграммы. Появится рамка с диагональной штриховкой и маленьким квадратом в каждом углу и в серединах её сторон. </para>
<para
>При наведении указателя мыши на любой из квадратов он должен превратиться в двуглавую диагональную стрелку. Размер диаграммы возможно изменить, перетащив один из этих квадратов с помощью <mousebutton
>левой</mousebutton
> кнопки мыши. Чтобы удалить диаграмму, щёлкните <mousebutton
>правой</mousebutton
> кнопкой мыши по одному из квадратов и в открывшемся контекстном меню выберите пункт <guimenuitem
>Удалить</guimenuitem
>.</para>
<para
>Чтобы переместить диаграмму, наведите на неё указатель мыши. Указатель должен измениться на крестик. Нажмите <mousebutton
>левую</mousebutton
> кнопку мыши, чтобы перетащить диаграмму в нужное место.</para>
<para
>Чтобы восстановить обычный вид диаграммы, просто щёлкните левой кнопкой мыши в любом месте вне области диаграммы.</para>
<para
>Чтобы изменить формат самой диаграммы, дважды щёлкните <mousebutton
>левой</mousebutton
> кнопкой мыши в области диаграммы. Диаграмма <guilabel
>Редактирование диаграммы</guilabel
> должна появиться в окне настройки. Эти инструменты позволяют изменять диаграмму.</para>
</sect1>

<sect1 id="insertdata">
<title
>Вставка внешних данных</title>
<para
>Для вставки данных из текстового файла или из буфера обмена выберите ячейку, в которой должен отображаться левый верхний элемент вставляемых данных, а затем выберите вариант <guimenuitem
>Из текстового файла...</guimenuitem
> или <guimenuitem
>Из буфера обмена...</guimenuitem
> во вложенном меню <menuchoice
><guimenu
>Вставка</guimenu
><guisubmenu
>Внешние данные</guisubmenu
> </menuchoice
>.</para>
<para
>В обоих случаях &sheets; будет предполагать, что данные находятся в формате <acronym
>CSV</acronym
> и будет открывать диалог, позволяющий указать, каким образом данные должны извлекаться из файла или буфера обмена и помещаться в ячейки рабочего листа.</para>
<para
>&sheets; может вставлять данные из базы данных <acronym
>SQL</acronym
>, если система поддерживает это. Сделать это возможно с помощью функции <menuchoice
><guimenu
>Вставка</guimenu
><guisubmenu
>Внешние данные</guisubmenu
><guimenuitem
>Из базы данных...</guimenuitem
> </menuchoice
>.</para>
</sect1>

<sect1 id="hyper">
<title
>Ячейки с ссылками</title>
<para
>Ячейку электронной таблицы возможно связать с действием, чтобы щелчок <mousebutton
>левой</mousebutton
> кнопкой по ячейке вызывал, например, используемый браузер. Чтобы заставить ячейку действовать таким образом, выделите её и воспользуйтесь пунктом меню <menuchoice
><guimenu
>Вставка</guimenu
><guimenuitem
>Ссылка...</guimenuitem
> </menuchoice
>. При этом откроется диалог <guilabel
>Вставить ссылку</guilabel
>, в котором возможно выбрать один из четырёх типов ссылок:</para>

<itemizedlist>
<listitem
><para
>При щелчке по ячейке с ссылкой <guilabel
>Интернет</guilabel
> в браузере по умолчанию откроется ссылка, введённая в текстовое поле <guilabel
>Адрес в Интернете:</guilabel
> диалога <guilabel
>Вставка ссылки</guilabel
>. Это может быть, например, <userinput
>http://www.calligra.org</userinput
>. </para
></listitem>

<listitem
><para
>Нажатие на ячейку, содержащую ссылку <guilabel
>Электронная почта</guilabel
>, откроет редактор электронной почты, заполнив поле To: указанным в текстовом поле адресом. Например, <userinput
>anon@example.com</userinput
>. </para
></listitem>

<listitem
><para
>При нажатии на ячейку со ссылкой <guilabel
>Файл</guilabel
> будет открыт файл или каталог, введённый в поле <guilabel
>Расположение файла:</guilabel
>, с помощью соответствующего приложения. </para
></listitem>

<listitem
><para
>Тип ссылки <guilabel
>Ячейка</guilabel
> содержит ссылку на ячейку &sheets;, введённую в поле <guilabel
>Ячейка:</guilabel
>. При щелчке <mousebutton
>левой</mousebutton
> кнопкой мыши по этой ячейке &sheets; переместит курсор в эту ячейку. </para
></listitem>
</itemizedlist>

<para
>Для всех четырёх типов ячеек со ссылками необходимо ввести какой-либо значимый текста в поле <guilabel
>Комментарий</guilabel
> диалога <guilabel
>Вставка ссылки</guilabel
>. Это текст, который появляется в ячейке.</para>
</sect1>

<sect1 id="validcheck">
<title
>Проверка на корректность</title>
<para
>&sheets; может автоматически проверять введённые данные на соответствие некоторым условиям и выводить всплывающее окно, если данные им не удовлетворяют.</para>
<para
>Для включения этой функции выберите ячейки, которые нужно проверять, и вызовите пункт меню <menuchoice
><guimenu
>Данные</guimenu
><guimenuitem
>Проверка...</guimenuitem
> </menuchoice
>. Появится диалог &sheets; <guilabel
>Проверка на корректность</guilabel
> с тремя вкладками.</para>
<para
>На вкладке <guilabel
>Значения</guilabel
> выберите из раскрывающегося списка <guilabel
>Разрешить:</guilabel
> тип данных, которые будут считаться правильными, а затем определите допустимую область значений, выбрав один из вариантов раскрывающегося списка <guilabel
>Данные:</guilabel
> и введя подходящие значения в одно или оба поля редактирования.</para>
<para
>После этого перейдет на вкладку <guilabel
>Оповещение об ошибке</guilabel
>. Здесь возможно выбрать тип окна сообщения (<guimenuitem
>Стоп</guimenuitem
>, <guimenuitem
>Предупреждения</guimenuitem
> или <guimenuitem
>Сведения</guimenuitem
>), которое появится, когда будет введено некорректное значение, и определить заголовок окна сообщения и текст сообщения.</para>
<!--FIXME missing Input Help tab-->
<para
>Обратите внимание, что эта функция проверяет только те данные, которые вводятся в ячейку, а для проверки результатов, получающихся при вычислении формул в ячейках, обратитесь к разделу «<link linkend="formatdata"
>Форматирование по условию</link
>».</para>
</sect1>

<sect1 id="protection">
<title
>Защита</title>

<sect2 id="doc-protection">
<title
>Защита документа</title>
<para
>При защите документа пользователь без пароля не сможет добавлять или удалять листы. Защита документа не касается ячеек.</para>
<para
>Выберите пункт меню <menuchoice
><guimenu
>Сервис</guimenu
><guimenuitem
>Защитить документ...</guimenuitem
></menuchoice
>. Появится диалог с запросом пароля. <guilabel
>Датчик надёжности пароля:</guilabel
> показывает, насколько безопасен введённый пароль. Чем длиннее полоса индикатора, тем надёжнее придуманный пароль.</para>
<para>
<mediaobject>
<imageobject>
<imagedata fileref="cellprotection1.png" format="PNG"/>
</imageobject>
<textobject>
<phrase
>Диалог «Защитить документ»</phrase>
</textobject>
</mediaobject>
</para>
<para
>Этот пароль будет запрошен для снятия защиты с документа.</para>
<para>
<mediaobject>
<imageobject>
<imagedata fileref="cellprotection2.png" format="PNG"/>
</imageobject>
<textobject>
<phrase
>Диалог «Снять защиту с документа»</phrase>
</textobject>
</mediaobject>
</para>
<para
>Если документ защищён, нельзя:</para>
<itemizedlist>
<listitem
><para
>Переименовать лист </para
></listitem>
<listitem
><para
>Вставить лист </para
></listitem>
<listitem
><para
>Удалить лист </para
></listitem>
<listitem
><para
>Скрыть лист </para
></listitem>
<listitem
><para
>Отобразить лист </para
></listitem>
<listitem
><para
>Получить свойства листа </para
></listitem>
<listitem
><para
>Группировать или разгруппировать ячейки </para
></listitem>
</itemizedlist>
</sect2>

<sect2 id="sheet-protection">
<title
>Защита листа</title>
<para
>Защита листа означает защиту содержимого всех защищённых ячеек и объектов на листе. С отдельных ячеек или выделения возможно снять защиту в пределах листа, подробнее в <link linkend="cell-protection"
>следующем разделе</link
>.</para>
<para
>Чтобы защитить лист, выберите <menuchoice
><guimenu
>Сервис</guimenu
><guimenuitem
>Защитить лист...</guimenuitem
></menuchoice
>. Появится диалог с запросом пароля. <guilabel
>Датчик надёжности пароля:</guilabel
> показывает, насколько безопасен введённый пароль. Чем длиннее полоса индикатора, тем надёжнее придуманный пароль.</para>
<para
>Этот пароль будет запрошен для снятия защиты с листа.</para>
<para
>Если лист защищён, нельзя:</para>
<itemizedlist>
<listitem
><para
>Вставить объект или диаграмму </para
></listitem>
<listitem
><para
>Форматировать ячейки </para
></listitem>
<listitem
><para
>Вставить строку или ряд </para
></listitem>
<listitem
><para
>Редактировать и изменять содержимое ячеек </para
></listitem>
<listitem
><para
>Изменять содержимое листа </para
></listitem>
</itemizedlist>

<note
><para
>Защита документа бывает особенно полезна для предотвращения случайного удаления формул.</para
></note>
</sect2>

<sect2 id="cell-protection">
<title
>Защита ячейки или выбранных ячеек</title>
<warning
><para
>Защита всех ячеек включена по умолчанию и эффективна при защите листа. Таким образом, при сохранении значения по умолчанию и защите листа все ячейки будут защищены.</para
></warning>
<para
>Если нужно защитить только определённые ячейки, данная защита, применяемая по умолчанию, должна быть отключена для всех других ячеек. Например, требуется, чтобы в большинство ячеек можно было вводить данные, поэтому следует снять флажок <guilabel
>Защищено</guilabel
> для тех ячеек и оставить защищёнными те, которые не должны быть изменены (например, заголовки). Таким образом, необходимо выполнить 3 действия для защиты только определённых ячеек: снять защиту со всех ячеек, выбрать ячейки, которые должны быть защищены, и защитить их, и затем защитить весь лист.</para>
<para
>Для снятия защиты со всех ячеек:</para>
<itemizedlist>
<listitem
><para
>Выделите весь лист с помощью мыши. </para
></listitem>
<listitem
><para
>Выберите пункт меню <menuchoice
><guimenu
>Формат</guimenu
><guimenuitem
>Формат ячеек...</guimenuitem
></menuchoice
>. </para
></listitem>
<listitem
><para
>В появившемся диалоге перейдите на вкладку <guilabel
>Защита ячеек</guilabel
>. </para
></listitem>
<listitem
><para
>Установите флажок <guilabel
>Скрыть всё</guilabel
> и снимите флажок <guilabel
>Защищено</guilabel
> для снятия защиты со всех ячеек. Тогда ячейки станут доступны для изменения. </para
></listitem>
</itemizedlist>
<para
>Для защиты диапазона ячеек или набора несмежных ячеек:</para>
<itemizedlist>
<listitem
><para
>Выберите диапазон или (при нажатой клавише <keycombo action="simul"
>&Ctrl;</keycombo
>) набор несмежных ячеек. </para
></listitem>
<listitem
><para
>Когда все нужные ячейки выделены, перейдите к пункту меню <menuchoice
><guimenu
>Формат</guimenu
><guimenuitem
>Формат ячеек...</guimenuitem
></menuchoice
>. </para
></listitem>
<listitem
><para
>В появившемся диалоге перейдите на вкладку <guilabel
>Защита ячеек</guilabel
>. </para
></listitem>
<listitem
><para
>Выберите пункт <guilabel
>Защищено</guilabel
> и затем нажмите <guibutton
>OK</guibutton
>. </para
></listitem>
</itemizedlist>
<para
>Как только ячейки будут отмечены для защиты, опция защиты должна быть включена на уровне листа, что означает, что требуется защитить весь лист, чтобы ячейка была эффективно защищена.</para>
<itemizedlist>
<listitem
><para
>Выберите <menuchoice
><guimenu
>Сервис</guimenu
><guimenuitem
>Защитить лист...</guimenuitem
></menuchoice
>. </para
></listitem>
<listitem
><para
>В появившемся диалоге введите надёжный пароль, затем введите его ещё раз для подтверждения. Нажмите <guibutton
>OK</guibutton
>. </para
></listitem>
<listitem
><para
>Невозможно редактировать защищённые ячейки в защищённых листах без снятия защиты со всего листа, все изменения листа будут запрещены. Например, никто не сможет вставлять строки или ряды, изменять ширину рядов или создавать вложенные диаграммы. </para
></listitem>
</itemizedlist>
</sect2>

<sect2 id="hide-formula">
<title
>Скрыть формулу ячейки</title>
<para
>Возможно, потребуется скрыть формулы от других людей. По умолчанию каждая ячейка защищена, а не скрыта. Но важно помнить, что эти атрибуты не имеют никакого эффекта, если сам лист не защищён.</para>
<para>
<mediaobject>
<imageobject>
<imagedata fileref="hideformula1.png" format="PNG"/>
</imageobject>
<textobject>
<phrase
>Ячейка по умолчанию, содержащая формулу</phrase>
</textobject>
</mediaobject>
</para>
<para
>Чтобы скрыть формулы ячеек, выберите соответствующую ячейку или диапазон ячеек или несмежные ячейки с помощью клавиши <keycombo action="simul"
>&Ctrl;</keycombo
>, а затем выберите пункт меню <menuchoice
><guimenu
>Формат</guimenu
><guimenuitem
>Формат ячейки...</guimenuitem
></menuchoice
>. В диалоге «Формат ячейки» перейдите на вкладку <guilabel
>Защита ячеек</guilabel
> и выберите функцию <guilabel
>Скрыть формулу</guilabel
>. После активации защиты листа результаты вычисления формул будут видны, но сами формулы будут скрыты. </para>
<para
>Теперь следует защитить лист: выберите <menuchoice
><guimenu
>Сервис</guimenu
><guimenuitem
>Защитить документ...</guimenuitem
></menuchoice
> для отображения диалога <guilabel
>Защитить документ</guilabel
>. Дважды введите надёжный пароль, чтобы никто не мог снять защиту с листа. </para>
<para
>Когда опция <guilabel
>Скрыть формулу</guilabel
> включена, а <guilabel
>Защищено</guilabel
> отключена, формула становится скрытой после защиты листа, но содержание ячейки может быть изменено.</para>
<para>
<mediaobject>
<imageobject>
<imagedata fileref="hideformula5.png" format="PNG"/>
</imageobject
>    
<textobject>
<phrase
>Опция <guilabel
>Скрыть формулу</guilabel
> включена, но ячейка не защищена, а лист защищён.</phrase>
</textobject>
</mediaobject>
</para>
<para
>Если опции <guilabel
>Скрыть формулы</guilabel
> и <guilabel
>Защищено</guilabel
> включены, формула становится скрытой после защиты листа и содержимое ячейки не может быть изменено.</para>
<para>
<mediaobject>
<imageobject>
<imagedata fileref="hideformula2.png" format="PNG"/>
</imageobject>
<textobject>
<phrase
>Опция <guilabel
>Скрыть всё</guilabel
> и <guilabel
>Защищено</guilabel
> включены в диалоге <guilabel
>Защита ячейки</guilabel
>, и лист защищён.</phrase>
</textobject>
</mediaobject>
</para>
<para
>Обратите внимание, что взломать пароль защищённого листа очень легко, поэтому обычная защита листа — это не лучшее решение, если требуется обеспечить максимальную защищённость работы.</para>
</sect2>

<sect2 id="hide-all">
<title
>Скрыть всё в ячейке</title>
<para
>Возможно скрыть как формулу, так и содержание ячейки, выбрав вариант <guilabel
>Скрыть всё</guilabel
> на вкладке защиты ячейки в меню <menuchoice
><guimenu
>Формат</guimenu
><guimenuitem
>Формат ячеек...</guimenuitem
></menuchoice
>. На снимке ниже ячейка не защищена (флажок <guilabel
>защищено</guilabel
> снят), поэтому содержимое ячейки возможно изменить.</para>
<para>
<mediaobject>
<imageobject>
<imagedata fileref="hideformula3.png" format="PNG"/>
</imageobject>
<textobject>
<phrase
>Опция <guilabel
>Скрыть всё</guilabel
> включена (ячейка не защищена) и лист защищён, только если</phrase>
</textobject>
</mediaobject>
</para>
<para
>Эта ячейка защищена, поэтому перезаписать её нельзя.</para>
<para>
<mediaobject>
<imageobject>
<imagedata fileref="hideformula4.png" format="PNG"/>
</imageobject>
<textobject>
<phrase
>Опция <guilabel
>Скрыть всё</guilabel
> и <guilabel
>Защищено</guilabel
> включены в Защите ячейки и лист защищён</phrase>
</textobject>
</mediaobject>
</para>
</sect2>
</sect1>


<sect1 id="other">
<title
>Другие возможности</title>
<!-- no split view in 2.4
<sect2 id="splitview">
<title
>Splitting the View</title>
<para
>If your spreadsheet is so large that you cannot see all of it at once, 
splitting &sheets;'s window into two or more views can help you work on it. 
This is done by selecting <menuchoice
><guimenu
>View</guimenu
><guimenuitem>
Split View</guimenuitem
></menuchoice
> which will split the current view into 
two parts. <menuchoice
><guimenu
>View</guimenu
><guisubmenu
>Splitter Orientation
</guisubmenu
></menuchoice
> lets you choose between 
<guimenuitem
>Horizontal</guimenuitem
> and <guimenuitem
>Vertical</guimenuitem
> 
splitting.</para>
<para
>This technique is particularly useful when you want to select an area 
of the spreadsheet that is larger than can be shown in one view, perhaps to
paste a copied cell into it. 
Use the scrollbars to position the two views to show the top left and 
bottom right cells of the wanted area, select the top left cell in one 
view then hold the &Shift; key pressed while you select the 
bottom right cell with the <mousebutton
>left</mousebutton
> mouse button.</para>
<para
>If there is more than one sheet in your document, you can show a 
different sheet in each of the split views.</para>
<para
>The relative sizes of the views can be changed by dragging the thick bar 
separating the views.</para>
<para
>To remove a view select <menuchoice
><guimenu
>View</guimenu
><guimenuitem>
Remove View</guimenuitem
></menuchoice
></para>
</sect2>
-->

<sect2 id="namedareas">
<title
>Именованные ячейки и области</title>
<para
>Возможно присвоить имя, например, <userinput
>foo</userinput
>, ячейке или любой области листа, выделив ячейку или область и выбрав <guimenuitem
>Имя диапазона...</guimenuitem
> из контекстного меню, вызываемого щелчком <mousebutton
>правой</mousebutton
> кнопки мыши. Это вызовет диалог <guilabel
>Название диапазона</guilabel
>, позволяющий ввести любое имя.</para>
<para
>Чтобы дать имя ячейке или области, выделите её, а затем введите имя в небольшом текстовом поле слева от панели инструментов «Формула», исправив ссылку на ячейку, которая обычно там отображается.</para>
<para
>При вводе в этой строки имени, которое уже используется, &sheets; выделит область, которая носит это имя.</para>
<para
>С помощью функции <menuchoice
><guimenu
>Данные</guimenu
><guimenuitem
>Именованные области...</guimenuitem
> </menuchoice
> возможно просмотреть список существующих имён и изменить фокус &sheets; на любое из них или удалить имя. </para>
<para
>Именованные ячейки особенно полезны в формулах в качестве альтернативы <link linkend="absolute"
>абсолютным ссылкам на ячейки</link
>, так как имена могут использоваться вместо обычных ссылок на ячейки, и они не изменяются при копировании ячейки, содержащих формулы. При использовании имени в качестве ссылки его необходимо заключать в одинарные кавычки.</para>
<para
>Например, если ячейке A1 присвоено имя <userinput
>fred </userinput
>, то можно будет ввести формулу, например, <userinput
>='fred' + 2 </userinput
>, в другую ячейку, в которой в результате всегда будет сумма значения в ячейке A1 и 2, независимо от того, куда эта ячейка будет скопирована.</para>
<para
>Обратите внимание, что имена ячеек и областей используют только нижний регистр.</para>
</sect2>

<sect2 id="cellcomments">
<title
>Комментарии к ячейкам</title>
<para
>Ячейка может содержать комментарий, который можно будет увидеть при работе с таблицей, но который не будет распечатан и обычно не виден.</para>
<para
>Чтобы добавить комментарий, выделите ячейку и выберите <guimenuitem
>Комментарий...</guimenuitem
> в контекстном меню, вызываемом щелчком <mousebutton
>правой</mousebutton
> кнопки мыши или в меню <guimenu
>Вставка</guimenu
> и введите свой комментарий в появившийся диалог <guilabel
>Комментарий</guilabel
>.</para>
<para
>Чтобы просмотреть комментарий, наведите указатель мыши на ячейку. Комментарий будет показан во всплывающей подсказке. </para>
<para
>При установке флажка <guilabel
>Показывать индикатор</guilabel
> в диалоге <guilabel
>Свойства листа</guilabel
> ячейки, содержащие комментарии, будут иметь маленький красный треугольник в правом верхнем углу.</para>
<para
>Чтобы открыть этот диалог, щёлкните <mousebutton
>правой</mousebutton
> кнопкой мыши по вкладке листа в нижней части главного окна и в открывшемся контекстном меню выберите пункт <guimenuitem
>Свойства листа</guimenuitem
>. Либо выберите его через меню <menuchoice
><guimenu
>Формат</guimenu
><guisubmenu
>Лист</guisubmenu
></menuchoice
>.</para>

<para
>Чтобы удалить комментарий из ячейки, щёлкните по ячейке правой кнопкой мыши и в открывшемся контекстном меню выберите пункт <guimenuitem
>Удалить комментарий</guimenuitem
> или выберите пункт меню <menuchoice
><guimenu
>Правка</guimenu
><guisubmenu
>Очистить</guisubmenu
> <guimenuitem
>Комментарий</guimenuitem
></menuchoice
>.</para>
</sect2>

</sect1>

</chapter>

<!--
Local Variables:
mode: sgml
sgml-parent-document: ("index.docbook" "book" "chapter")
sgml-minimize-attributes:nil
sgml-general-insert-case:lower
sgml-indent-step:0
sgml-indent-data:nil
End:
-->
