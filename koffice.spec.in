# You might want to change the next 2 lines, the rest should be ok
%define qtdir /usr/lib/qt-3.0.0
Prefix: /opt/kde3

Name: koffice
Icon: kde-icon.xpm
URL: http://www.kde.org
Summary: Set of office applications for KDE
Version: @VERSION@
Release: 1
Source: ftp://ftp.kde.org/pub/kde/stable/%{version}/distribution/tar/generic/source/%{name}-%{version}.tar.bz2
Group: User Interface/Desktops
Copyright: GPL
BuildRoot: /var/tmp/%{name}-buildroot
Requires: kdesupport

%description
Office applications for the K Desktop Environment 2.0.
KOffice contains KWord (word processor), KSpread (spreadsheet), KPresenter
(Presentations) and KChart (diagram generator).

%prep
rm -rf $RPM_BUILD_ROOT
%setup -q

make -f Makefile.cvs

%build
export KDEDIR=%{prefix} QTDIR=%{qtdir}
CFLAGS="$RPM_OPT_FLAGS" CXXFLAGS="$RPM_OPT_FLAGS -DNO_DEBUG -DNDEBUG" \
	./configure  \
	--prefix=%{prefix}

make

%install
make RUN_KAPPFINDER=no DESTDIR=$RPM_BUILD_ROOT install-strip

{
	pushd $RPM_BUILD_ROOT
	find . -type d | sed '1,2d;s,^\.,\%attr(-\,root\,root) \%dir ,' > \
		$RPM_BUILD_DIR/file.list.%{name}

	find . -type f | sed -e 's,^\.,\%attr(-\,root\,root) ,' \
		-e '/\/config\//s|^|%config|' >> \
		$RPM_BUILD_DIR/file.list.%{name}

	find . -type l | sed 's,^\.,\%attr(-\,root\,root) ,' >> \
		$RPM_BUILD_DIR/file.list.%{name}
	popd
}

%clean
rm -rf $RPM_BUILD_ROOT $RPM_BUILD_DIR/files.list.%{name}

%files -f ../file.list.%{name} 

%changelog
* Thu May 11 2000 Bernhard Rosenkraenzer <bero@redhat.com>
- initial RPM
